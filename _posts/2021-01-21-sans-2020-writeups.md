---
layout: post
title:  "Writeup of some of the exercises from SANS Holiday Hack 2020"
date:   2020-12-21 12:00:00 +0100
categories: sans JS web-magic
---
# Objective 2
## Investigate S3 Bucket
### Objective text: 
When you unwrap the over-wrapped file, what text string is inside the package? Talk to Shinny Upatree in front of the castle for hints on this challenge.

#### Motd text:
Can you help me? Santa has been experimenting with new wrapping technology, and
we've run into a ribbon-curling nightmare!
We store our essential data assets in the cloud, and what a joy it's been!
Except I don't remember where, and the Wrapper3000 is on the fritz!

Can you find the missing package, and unwrap it all the way?

Hints: Use the file command to identify a file type. You can also examine
tool help using the man command. Search all man pages for a string such as
a file extension using the apropos command.

To see this help again, run cat /etc/motd.

### Solution:
Since the word Wrapper3000 was mentioned in the motd was it added to the bucket list.
Then the bucket_finder.rb script was ran and revealed the following open bucket:

Bucket Found: wrapper3000 ( http://s3.amazonaws.com/wrapper3000 )
        <Public> http://s3.amazonaws.com/wrapper3000/package
 
The package is unpacked in two parts.

First part was done using cyberchef:
https://gchq.github.io/CyberChef/#recipe=From_Base64('A-Za-z0-9%2B/%3D',true)Unzip('',false)Bzip2_Decompress(false)Untar()From_Hexdump()&input=VUVzREJBb0FBQUFBQUlBd2hGRWJSVDhhbndFQUFKOEJBQUFjQUJ3QWNHRmphMkZuWlM1MGVIUXVXaTU0ZWk1NGVHUXVkR0Z5TG1KNk1sVlVDUUFEb0JmS1g2QVh5bDkxZUFzQUFRVDJBUUFBQkJRQUFBQkNXbWc1TVVGWkpsTloya3RpdndBQkh2K1EzaEFTZ0dTbi8vQXZCeER3Zi94ZTBnUUFBQWd3QVZta1lSVEtlMVBWTTlVMGVrTWcycG9BQUFHZ1BVUFVHcWVoaENNU2dhQm9BRDFOTkFBQUF5RW1KcFI1UUdnMGJTUFUvVkEwZW85SWFIcUJreHcyWVpLMk5VQVNPZWdESXp3TVhNSEJDRkFDZ0lFdlEySnJnOFY1MHREamg2MVB0M1E4Q21ncEZGdW5jMUlwdWkrU3FzWUIwNE0vZ1dLS2MwVnMyRFhremVKbWlrdElOcWpvM0pqS0FBNGRMZ0x0UE4xNW9BRExlODB0bmZMR1hoSVdhSk1pRWVTWDk5MnV4b2RSSjZFQXpJRnpxU2JXdG5OcUNURURNTDlBSzdISFN6eXlCWUt3Q0ZCVkpoMTdUNjM2YTZZZ3lqWDBlRTBJc0NiamNCa1JQZ2tLejZxMG9rYjFzV2ljTWFreTJNZ3NxdzJuVW01YXlQSFVlSWt0bkJJdmtpVVd4WUVpUnM1bkZPTThNVGs4U2l0VjdsY3hPS3N0MlFlZFN4Wjg1MWNlRFFleHNMc0ozQzg5Wi9nUTZYbjZLQktxRnNLeVRrYXFPKzFGZ21JbXRIS29Ka01jdGQyQjlKa2N3dk1yK2hXSUVjSVFqQVpHaFNLWU5QeEhKRnFKM3QzMlZqZ24vT0dkUUppSUh2NHU1SXB3b1NHMGxzVitVRXNCQWg0RENnQUFBQUFBZ0RDRVVSdEZQeHFmQVFBQW53RUFBQndBR0FBQUFBQUFBQUFBQUtTQkFBQUFBSEJoWTJ0aFoyVXVkSGgwTGxvdWVIb3VlSGhrTG5SaGNpNWllakpWVkFVQUE2QVh5bDkxZUFzQUFRVDJBUUFBQkJRQUFBQlFTd1VHQUFBQUFBRUFBUUJpQUFBQTlRRUFBQUFB

The result of this was downloaded and then moved to part 2.

Second part was done using the terminal running the following commands:
{%highlight bash%}
$ mv download.dat download.dat.xz
$ unxz download.dat.xz 
$ mv download.dat download.dat.gz
$ cat download.dat 
North Pole: The Frostiest Place on Earth
{%endhighlight%}

The output of the cat command is the solution for the objective.

# Objective 3
## Point-of-Sale Password Recovery
### Objective text: 
Help Sugarplum Mary in the Courtyard find the supervisor password for the point-of-sale terminal. What's the password?

The POS application is an electron app. The app is unpacked using 7z. See the following commands for how the password was found:
{%highlight bash%}
$ 7z x ../santa-shop.exe
$ cd \$PLUGINSDIR/
$ 7z x app-64.7z
$ cd resources/
$ strings app.asar | less
const SANTA_PASSWORD = 'santapass';
{%endhighlight%}

The password is found to be santapass


# Objective 4
## Operate the Santavator
### Objective text:
Talk to Pepper Minstix in the entryway to get some hints about the Santavator.

There is more than one way to solve this. One way is to find all the items scattered across the castle. Another way is to do a bit of browser magic.

### Solutions:
Using the first method can it be a good idea to disable other players to make it easier to spot the stuff.

Another way is to use the javascript console in the browser.

First stop the simulation by overwriting the render function:
{%highlight javascript%}
render = undefined
{%endhighlight%}
Then power on all buttons:
{%highlight javascript%}
document.querySelectorAll('button').forEach(function (b) { console.log(b); b.classList += ' powered'})
{%endhighlight%}
Add the workshop button
{%highlight javascript%}
tokens.push("workshop-button")
btn15img.classList.add('found');
{%endhighlight%}
Last add yourself to be santa at all times:
{%highlight javascript%}
tokens.push('besanta')
{%endhighlight%}

Now you can use all buttons.
